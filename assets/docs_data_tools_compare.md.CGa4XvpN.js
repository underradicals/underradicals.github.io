import{_ as d,c as a,o as s,ah as i}from"./chunks/framework.BaqsfJuc.js";const m=JSON.parse('{"title":"Comparing Data Tools","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"docs/data_tools/compare.md","filePath":"docs/data_tools/compare.md"}'),e={name:"docs/data_tools/compare.md"};function r(l,t,n,h,o,p){return s(),a("div",null,[...t[0]||(t[0]=[i(`<h1 id="comparing-data-tools" tabindex="-1">Comparing Data Tools <a class="header-anchor" href="#comparing-data-tools" aria-label="Permalink to “Comparing Data Tools”">​</a></h1><h2 id="spark-vs-pandas-vs-polars-vs-sql-sqlite" tabindex="-1">Spark vs Pandas vs Polars vs SQL (SQLite) <a class="header-anchor" href="#spark-vs-pandas-vs-polars-vs-sql-sqlite" aria-label="Permalink to “Spark vs Pandas vs Polars vs SQL (SQLite)”">​</a></h2><p>For this exercise we will be using some data from two files: <code>customers.csv</code> and <code>transactions.csv</code>. For various actions we compare these popular methods for interacting with the data. Besides SQL, each tool has some setup involved, but the actual logic for the particular <code>action</code> in question is mostly very similar, however, sometimes it can be very different.</p><details class="details custom-block"><summary>Customer Data</summary><table tabindex="0"><thead><tr><th>customer_id</th><th>customer_name</th><th>email</th><th>phone</th><th>account_type</th><th>credit_limit</th><th>signup_date</th></tr></thead><tbody><tr><td>1</td><td>Customer 1</td><td><a href="mailto:customer1@email.com" target="_blank" rel="noreferrer">customer1@email.com</a></td><td>555-9768</td><td>Premium</td><td>36307.84</td><td>2023-10-04</td></tr><tr><td>2</td><td>Customer 2</td><td><a href="mailto:customer2@email.com" target="_blank" rel="noreferrer">customer2@email.com</a></td><td>555-2590</td><td>Basic</td><td>32940.55</td><td>2021-09-01</td></tr><tr><td>3</td><td>Customer 3</td><td><a href="mailto:customer3@email.com" target="_blank" rel="noreferrer">customer3@email.com</a></td><td></td><td>Basic</td><td>5857.91</td><td>2020-01-11</td></tr><tr><td>4</td><td>Customer 4</td><td><a href="mailto:customer4@email.com" target="_blank" rel="noreferrer">customer4@email.com</a></td><td>555-8829</td><td>Premium</td><td>4449.43</td><td>2021-01-20</td></tr><tr><td>5</td><td>Customer 5</td><td><a href="mailto:customer5@email.com" target="_blank" rel="noreferrer">customer5@email.com</a></td><td>555-8271</td><td>Premium</td><td>14111.04</td><td>2020-12-02</td></tr><tr><td>6</td><td>Customer 6</td><td><a href="mailto:customer6@email.com" target="_blank" rel="noreferrer">customer6@email.com</a></td><td></td><td>Standard</td><td>33991.89</td><td>2020-06-26</td></tr><tr><td>7</td><td>Customer 7</td><td><a href="mailto:customer7@email.com" target="_blank" rel="noreferrer">customer7@email.com</a></td><td>555-8719</td><td>Premium</td><td>5779.04</td><td>2021-04-16</td></tr><tr><td>8</td><td>Customer 8</td><td><a href="mailto:customer8@email.com" target="_blank" rel="noreferrer">customer8@email.com</a></td><td>555-4043</td><td>Basic</td><td>27572.14</td><td>2022-04-20</td></tr><tr><td>9</td><td>Customer 9</td><td><a href="mailto:customer9@email.com" target="_blank" rel="noreferrer">customer9@email.com</a></td><td>555-4276</td><td>Basic</td><td>19972.46</td><td>2021-01-15</td></tr><tr><td>10</td><td>Customer 10</td><td><a href="mailto:customer10@email.com" target="_blank" rel="noreferrer">customer10@email.com</a></td><td>555-6148</td><td>Premium</td><td>16975.2</td><td>2021-08-11</td></tr><tr><td>11</td><td>Customer 11</td><td><a href="mailto:customer11@email.com" target="_blank" rel="noreferrer">customer11@email.com</a></td><td>555-4570</td><td>Standard</td><td>25379.41</td><td>2021-08-17</td></tr><tr><td>12</td><td>Customer 12</td><td><a href="mailto:customer12@email.com" target="_blank" rel="noreferrer">customer12@email.com</a></td><td></td><td>Premium</td><td>28596.82</td><td>2023-10-19</td></tr><tr><td>13</td><td>Customer 13</td><td><a href="mailto:customer13@email.com" target="_blank" rel="noreferrer">customer13@email.com</a></td><td>555-2595</td><td>Premium</td><td>28817.53</td><td>2022-06-17</td></tr><tr><td>14</td><td>Customer 14</td><td><a href="mailto:customer14@email.com" target="_blank" rel="noreferrer">customer14@email.com</a></td><td>555-2175</td><td>Basic</td><td>20712.1</td><td>2020-12-20</td></tr><tr><td>15</td><td>Customer 15</td><td><a href="mailto:customer15@email.com" target="_blank" rel="noreferrer">customer15@email.com</a></td><td></td><td>Premium</td><td>37689.63</td><td>2023-10-12</td></tr><tr><td>16</td><td>Customer 16</td><td><a href="mailto:customer16@email.com" target="_blank" rel="noreferrer">customer16@email.com</a></td><td>555-7266</td><td>Premium</td><td>38340.77</td><td>2022-05-15</td></tr><tr><td>17</td><td>Customer 17</td><td><a href="mailto:customer17@email.com" target="_blank" rel="noreferrer">customer17@email.com</a></td><td>555-1367</td><td>Premium</td><td>3747.57</td><td>2023-04-05</td></tr><tr><td>18</td><td>Customer 18</td><td><a href="mailto:customer18@email.com" target="_blank" rel="noreferrer">customer18@email.com</a></td><td>555-8288</td><td>Premium</td><td>12302.16</td><td>2020-11-18</td></tr><tr><td>19</td><td>Customer 19</td><td><a href="mailto:customer19@email.com" target="_blank" rel="noreferrer">customer19@email.com</a></td><td>555-9901</td><td>Standard</td><td>49511.0</td><td>2022-12-23</td></tr><tr><td>20</td><td>Customer 20</td><td><a href="mailto:customer20@email.com" target="_blank" rel="noreferrer">customer20@email.com</a></td><td></td><td>Standard</td><td>39116.11</td><td>2021-01-12</td></tr><tr><td>21</td><td>Customer 21</td><td><a href="mailto:customer21@email.com" target="_blank" rel="noreferrer">customer21@email.com</a></td><td>555-6673</td><td>Basic</td><td>41865.68</td><td>2022-12-05</td></tr><tr><td>22</td><td>Customer 22</td><td><a href="mailto:customer22@email.com" target="_blank" rel="noreferrer">customer22@email.com</a></td><td>555-5575</td><td>Basic</td><td>48432.67</td><td>2021-11-08</td></tr><tr><td>23</td><td>Customer 23</td><td><a href="mailto:customer23@email.com" target="_blank" rel="noreferrer">customer23@email.com</a></td><td>555-8618</td><td>Standard</td><td>20061.97</td><td>2021-11-13</td></tr><tr><td>24</td><td>Customer 24</td><td><a href="mailto:customer24@email.com" target="_blank" rel="noreferrer">customer24@email.com</a></td><td>555-6487</td><td>Basic</td><td>39008.16</td><td>2023-02-25</td></tr><tr><td>25</td><td>Customer 25</td><td><a href="mailto:customer25@email.com" target="_blank" rel="noreferrer">customer25@email.com</a></td><td>555-6855</td><td>Premium</td><td>12889.93</td><td>2021-08-11</td></tr><tr><td>26</td><td>Customer 26</td><td><a href="mailto:customer26@email.com" target="_blank" rel="noreferrer">customer26@email.com</a></td><td>555-8298</td><td>Standard</td><td>41137.33</td><td>2023-03-27</td></tr><tr><td>27</td><td>Customer 27</td><td><a href="mailto:customer27@email.com" target="_blank" rel="noreferrer">customer27@email.com</a></td><td>555-5321</td><td>Premium</td><td>22839.49</td><td>2020-07-12</td></tr><tr><td>28</td><td>Customer 28</td><td><a href="mailto:customer28@email.com" target="_blank" rel="noreferrer">customer28@email.com</a></td><td>555-7884</td><td>Standard</td><td>7637.83</td><td>2023-09-20</td></tr><tr><td>29</td><td>Customer 29</td><td><a href="mailto:customer29@email.com" target="_blank" rel="noreferrer">customer29@email.com</a></td><td></td><td>Basic</td><td>28992.53</td><td>2023-08-11</td></tr><tr><td>30</td><td>Customer 30</td><td><a href="mailto:customer30@email.com" target="_blank" rel="noreferrer">customer30@email.com</a></td><td>555-1906</td><td>Standard</td><td>26907.5</td><td>2020-09-04</td></tr><tr><td>31</td><td>Customer 31</td><td></td><td>555-3466</td><td>Standard</td><td>4242.89</td><td>2022-10-23</td></tr><tr><td>32</td><td>Customer 32</td><td><a href="mailto:customer32@email.com" target="_blank" rel="noreferrer">customer32@email.com</a></td><td>555-9962</td><td>Standard</td><td>8682.17</td><td>2021-04-11</td></tr><tr><td>33</td><td>Customer 33</td><td></td><td>555-1861</td><td>Premium</td><td>48181.48</td><td>2022-10-14</td></tr><tr><td>34</td><td>Customer 34</td><td><a href="mailto:customer34@email.com" target="_blank" rel="noreferrer">customer34@email.com</a></td><td>555-7099</td><td>Standard</td><td>7730.41</td><td>2022-11-14</td></tr><tr><td>35</td><td>Customer 35</td><td><a href="mailto:customer35@email.com" target="_blank" rel="noreferrer">customer35@email.com</a></td><td>555-9947</td><td>Basic</td><td>2692.5</td><td>2020-02-22</td></tr><tr><td>36</td><td>Customer 36</td><td><a href="mailto:customer36@email.com" target="_blank" rel="noreferrer">customer36@email.com</a></td><td>555-5152</td><td>Premium</td><td>16129.56</td><td>2020-06-11</td></tr><tr><td>37</td><td>Customer 37</td><td><a href="mailto:customer37@email.com" target="_blank" rel="noreferrer">customer37@email.com</a></td><td>555-9281</td><td>Basic</td><td>4753.41</td><td>2023-08-11</td></tr><tr><td>38</td><td>Customer 38</td><td><a href="mailto:customer38@email.com" target="_blank" rel="noreferrer">customer38@email.com</a></td><td>555-9244</td><td>Standard</td><td>42398.55</td><td>2023-04-23</td></tr><tr><td>39</td><td>Customer 39</td><td><a href="mailto:customer39@email.com" target="_blank" rel="noreferrer">customer39@email.com</a></td><td>555-5626</td><td>Standard</td><td>21906.16</td><td>2022-06-11</td></tr><tr><td>40</td><td>Customer 40</td><td><a href="mailto:customer40@email.com" target="_blank" rel="noreferrer">customer40@email.com</a></td><td>555-6182</td><td>Premium</td><td>28809.77</td><td>2020-07-09</td></tr><tr><td>41</td><td>Customer 41</td><td><a href="mailto:customer41@email.com" target="_blank" rel="noreferrer">customer41@email.com</a></td><td>555-8629</td><td>Standard</td><td>45524.17</td><td>2023-04-30</td></tr><tr><td>42</td><td>Customer 42</td><td><a href="mailto:customer42@email.com" target="_blank" rel="noreferrer">customer42@email.com</a></td><td>555-5345</td><td>Standard</td><td>9943.52</td><td>2023-08-16</td></tr><tr><td>43</td><td>Customer 43</td><td><a href="mailto:customer43@email.com" target="_blank" rel="noreferrer">customer43@email.com</a></td><td>555-9488</td><td>Standard</td><td>10698.98</td><td>2023-03-22</td></tr><tr><td>44</td><td>Customer 44</td><td></td><td>555-3388</td><td>Basic</td><td>3196.65</td><td>2021-07-07</td></tr><tr><td>45</td><td>Customer 45</td><td></td><td>555-4124</td><td>Standard</td><td>13501.6</td><td>2021-10-08</td></tr><tr><td>46</td><td>Customer 46</td><td><a href="mailto:customer46@email.com" target="_blank" rel="noreferrer">customer46@email.com</a></td><td>555-8605</td><td>Basic</td><td>36665.8</td><td>2023-04-04</td></tr><tr><td>47</td><td>Customer 47</td><td><a href="mailto:customer47@email.com" target="_blank" rel="noreferrer">customer47@email.com</a></td><td>555-1325</td><td>Standard</td><td>43873.06</td><td>2020-02-08</td></tr><tr><td>48</td><td>Customer 48</td><td></td><td>555-9298</td><td>Standard</td><td>27285.09</td><td>2020-08-08</td></tr><tr><td>49</td><td>Customer 49</td><td><a href="mailto:customer49@email.com" target="_blank" rel="noreferrer">customer49@email.com</a></td><td>555-1066</td><td>Standard</td><td>33620.84</td><td>2022-06-22</td></tr><tr><td>50</td><td>Customer 50</td><td><a href="mailto:customer50@email.com" target="_blank" rel="noreferrer">customer50@email.com</a></td><td>555-6506</td><td>Basic</td><td>28081.52</td><td>2022-06-22</td></tr></tbody></table></details><details class="details custom-block"><summary>Transactions Data</summary><table tabindex="0"><thead><tr><th>transaction_id</th><th>customer_id</th><th>transaction_date</th><th>amount</th><th>merchant</th><th>category</th><th>payment_method</th><th>fee</th><th>status</th><th>is_fraud</th></tr></thead><tbody><tr><td>1</td><td>20</td><td>2024-09-23</td><td>368.57</td><td>Amazon</td><td>Clothing</td><td></td><td>9.21</td><td>Failed</td><td>False</td></tr><tr><td>2</td><td>38</td><td>2024-03-04</td><td>1825.21</td><td>Costco</td><td>Electronics</td><td>Credit Card</td><td>45.63</td><td>Completed</td><td>False</td></tr><tr><td>3</td><td>3</td><td>2024-08-04</td><td>369.67</td><td>Target</td><td>Clothing</td><td></td><td>9.24</td><td>Pending</td><td>True</td></tr><tr><td>4</td><td>13</td><td>2023-03-04</td><td>800.41</td><td>Walmart</td><td></td><td>Debit Card</td><td>20.01</td><td>Completed</td><td>False</td></tr><tr><td>5</td><td>17</td><td>2024-01-12</td><td>3420.25</td><td>Target</td><td>Clothing</td><td>Credit Card</td><td>85.51</td><td>Pending</td><td>False</td></tr><tr><td>6</td><td>38</td><td>2023-07-11</td><td>425.04</td><td></td><td>Entertainment</td><td>Credit Card</td><td>10.63</td><td>Pending</td><td>False</td></tr><tr><td>7</td><td>12</td><td>2023-02-17</td><td>3937.05</td><td></td><td></td><td></td><td>98.43</td><td>Pending</td><td>False</td></tr><tr><td>8</td><td>34</td><td>2023-10-09</td><td>4432.32</td><td></td><td>Electronics</td><td>Credit Card</td><td></td><td>Failed</td><td>False</td></tr><tr><td>9</td><td>45</td><td>2023-03-17</td><td>907.79</td><td>Walmart</td><td>Electronics</td><td>PayPal</td><td>22.69</td><td>Completed</td><td>False</td></tr><tr><td>10</td><td>17</td><td>2024-11-18</td><td>3243.31</td><td>Walmart</td><td>Entertainment</td><td>Debit Card</td><td>81.08</td><td>Pending</td><td>False</td></tr><tr><td>11</td><td>101</td><td>2024-05-26</td><td>847.24</td><td>Best Buy</td><td>Clothing</td><td>PayPal</td><td>21.18</td><td>Failed</td><td>False</td></tr><tr><td>12</td><td>12</td><td>2024-03-30</td><td>935.91</td><td>Walmart</td><td>Clothing</td><td>PayPal</td><td>23.4</td><td>Pending</td><td>False</td></tr><tr><td>13</td><td>3</td><td>2024-01-26</td><td>501.09</td><td>Amazon</td><td>Electronics</td><td>Debit Card</td><td>12.53</td><td>Completed</td><td>False</td></tr><tr><td>14</td><td>42</td><td>2024-11-08</td><td>614.13</td><td></td><td>Groceries</td><td>Credit Card</td><td>15.35</td><td>Completed</td><td>False</td></tr><tr><td>15</td><td>29</td><td>2024-10-21</td><td>2427.34</td><td>Target</td><td></td><td>PayPal</td><td>60.68</td><td>Pending</td><td>False</td></tr><tr><td>16</td><td>22</td><td>2024-06-13</td><td>2092.33</td><td></td><td>Entertainment</td><td>Credit Card</td><td>52.31</td><td>Pending</td><td>False</td></tr><tr><td>17</td><td>9</td><td>2023-02-14</td><td>2632.23</td><td>Best Buy</td><td>Electronics</td><td>Credit Card</td><td></td><td>Completed</td><td>False</td></tr><tr><td>18</td><td>38</td><td>2024-10-03</td><td>2366.26</td><td>Target</td><td>Groceries</td><td></td><td>59.16</td><td>Completed</td><td>False</td></tr><tr><td>19</td><td>5</td><td>2023-03-27</td><td>2886.74</td><td>Walmart</td><td>Groceries</td><td>Debit Card</td><td>72.17</td><td>Pending</td><td>False</td></tr><tr><td>20</td><td>34</td><td>2023-01-01</td><td>16.89</td><td>Costco</td><td>Entertainment</td><td></td><td>0.42</td><td>Failed</td><td>False</td></tr><tr><td>21</td><td>13</td><td>2024-12-11</td><td>2003.34</td><td></td><td>Entertainment</td><td>PayPal</td><td>50.08</td><td>Pending</td><td>False</td></tr><tr><td>22</td><td>27</td><td>2024-10-31</td><td>4221.48</td><td>Best Buy</td><td>Electronics</td><td>Credit Card</td><td>105.54</td><td>Failed</td><td>False</td></tr><tr><td>23</td><td>41</td><td>2024-03-31</td><td>4081.89</td><td>Target</td><td></td><td>Credit Card</td><td>102.05</td><td>Failed</td><td>False</td></tr><tr><td>24</td><td>1</td><td>2023-11-22</td><td>1898.95</td><td>Costco</td><td>Entertainment</td><td>PayPal</td><td></td><td>Pending</td><td>False</td></tr><tr><td>25</td><td>5</td><td>2023-10-11</td><td>158.18</td><td>Walmart</td><td>Entertainment</td><td>Debit Card</td><td>3.95</td><td>Failed</td><td>False</td></tr><tr><td>26</td><td>11</td><td>2023-07-12</td><td>4671.51</td><td>Target</td><td>Electronics</td><td>PayPal</td><td></td><td>Completed</td><td>False</td></tr><tr><td>27</td><td>13</td><td>2023-10-03</td><td>3692.06</td><td>Target</td><td>Electronics</td><td>Debit Card</td><td>92.3</td><td>Pending</td><td>False</td></tr><tr><td>28</td><td>5</td><td>2024-11-19</td><td>1771.78</td><td>Amazon</td><td></td><td>Debit Card</td><td>44.29</td><td>Pending</td><td>False</td></tr><tr><td>29</td><td>7</td><td>2024-01-06</td><td>644.34</td><td>Best Buy</td><td>Electronics</td><td>Credit Card</td><td>16.11</td><td>Pending</td><td>False</td></tr><tr><td>30</td><td>105</td><td>2023-04-19</td><td>1177.46</td><td>Costco</td><td>Groceries</td><td>Debit Card</td><td></td><td>Completed</td><td>False</td></tr><tr><td>31</td><td>108</td><td>2024-03-09</td><td>2896.3</td><td>Walmart</td><td>Groceries</td><td></td><td>72.41</td><td>Pending</td><td>False</td></tr><tr><td>32</td><td>15</td><td>2023-03-17</td><td>2634.9</td><td>Amazon</td><td>Electronics</td><td>Credit Card</td><td>65.87</td><td>Failed</td><td>False</td></tr><tr><td>33</td><td>18</td><td>2024-07-08</td><td>1436.45</td><td>Target</td><td>Electronics</td><td>PayPal</td><td>35.91</td><td>Failed</td><td>False</td></tr><tr><td>34</td><td>44</td><td>2023-09-09</td><td>43.36</td><td>Target</td><td></td><td>Debit Card</td><td>1.08</td><td>Completed</td><td>False</td></tr><tr><td>35</td><td>19</td><td>2024-08-01</td><td>461.43</td><td>Target</td><td></td><td></td><td></td><td>Failed</td><td>False</td></tr><tr><td>36</td><td>31</td><td>2024-01-23</td><td>1281.94</td><td>Costco</td><td>Clothing</td><td>Debit Card</td><td>32.05</td><td>Failed</td><td>False</td></tr><tr><td>37</td><td>43</td><td>2024-09-03</td><td>3309.17</td><td>Walmart</td><td>Groceries</td><td>PayPal</td><td>82.73</td><td>Pending</td><td>False</td></tr><tr><td>38</td><td>110</td><td>2023-07-15</td><td>4081.56</td><td>Amazon</td><td>Clothing</td><td>PayPal</td><td>102.04</td><td>Pending</td><td>False</td></tr><tr><td>39</td><td>5</td><td>2024-07-17</td><td>4117.67</td><td>Costco</td><td>Groceries</td><td>Debit Card</td><td>102.94</td><td>Failed</td><td>False</td></tr><tr><td>40</td><td>6</td><td>2024-03-18</td><td>1970.6</td><td>Costco</td><td></td><td>Credit Card</td><td>49.27</td><td>Completed</td><td>False</td></tr><tr><td>41</td><td>44</td><td>2024-04-03</td><td>4009.64</td><td>Walmart</td><td>Entertainment</td><td>Debit Card</td><td></td><td>Pending</td><td>False</td></tr><tr><td>42</td><td>40</td><td>2023-07-12</td><td>3238.13</td><td>Target</td><td>Clothing</td><td>Credit Card</td><td></td><td>Completed</td><td>False</td></tr><tr><td>43</td><td>38</td><td>2024-01-23</td><td>3180.48</td><td>Costco</td><td>Entertainment</td><td>Debit Card</td><td></td><td>Completed</td><td>False</td></tr><tr><td>44</td><td>20</td><td>2023-09-28</td><td>1402.16</td><td>Best Buy</td><td>Entertainment</td><td>Debit Card</td><td>35.05</td><td>Failed</td><td>False</td></tr><tr><td>45</td><td>4</td><td>2024-10-25</td><td>2827.95</td><td>Walmart</td><td>Groceries</td><td>Debit Card</td><td>70.7</td><td>Completed</td><td>False</td></tr><tr><td>46</td><td>27</td><td>2023-12-08</td><td>3174.68</td><td>Amazon</td><td></td><td>PayPal</td><td></td><td>Pending</td><td>False</td></tr><tr><td>47</td><td>23</td><td>2024-06-13</td><td>1374.58</td><td>Costco</td><td>Clothing</td><td>Debit Card</td><td>34.36</td><td>Completed</td><td>False</td></tr><tr><td>48</td><td>30</td><td>2024-12-07</td><td>1552.54</td><td>Amazon</td><td>Groceries</td><td></td><td>38.81</td><td>Completed</td><td>False</td></tr><tr><td>49</td><td>30</td><td>2024-02-09</td><td>1041.88</td><td></td><td></td><td>Debit Card</td><td>26.05</td><td>Pending</td><td>False</td></tr><tr><td>50</td><td>16</td><td>2024-11-24</td><td>2543.75</td><td>Walmart</td><td>Groceries</td><td></td><td>63.59</td><td>Pending</td><td>False</td></tr></tbody></table></details><p>To fully transparent, SQLite databases do not just come with data handmaid. So how do you get data into a SQLite database? There are several ways, here are a few.</p><h3 id="seeding-data" tabindex="-1">Seeding Data <a class="header-anchor" href="#seeding-data" aria-label="Permalink to “Seeding Data”">​</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-2836" id="tab-2837" checked><label data-title="SQLIte CLI Tool" for="tab-2837">SQLIte CLI Tool</label><input type="radio" name="group-2836" id="tab-2838"><label data-title="Pandas" for="tab-2838">Pandas</label><input type="radio" name="group-2836" id="tab-2839"><label data-title="Polars" for="tab-2839">Polars</label><input type="radio" name="group-2836" id="tab-2840"><label data-title="Apache Spark" for="tab-2840">Apache Spark</label></div><div class="blocks"><div class="language-sh active"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data.csv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablename</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load the CSV data into a Pandas DataFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;../data/customers.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a connection to a new or existing SQLite database</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sqlite3.connect(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;finance.db&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Write the data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.to_sql(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;customers&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, conn, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">if_exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;replace&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conn.commit()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conn.close()</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create SQLite engine</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">engine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_engine(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sqlite:///../finance.db&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load CSV data into Polars DataFrames</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dataframe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pl.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;../../data/customers.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Write the data to a SQLite table</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dataframe.write_database(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;customers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">engine, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">if_exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;replace&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spark </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparkSession.builder.appName(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;IngestionApp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .master(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;local[*]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .config(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;spark.jars&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/spark/jars/sqlite-jdbc-3.45.1.0.jar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .getOrCreate()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> spark.read.csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;../../data/customers.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">header</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inferSchema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jdbc_url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;jdbc:sqlite:../../finance.db&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;customers&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">properties </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;org.sqlite.JDBC&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    df.write.format(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jdbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, jdbc_url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dbtable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, table_name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;driver&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, properties)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .mode(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;overwrite&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .save()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spark.stop()</span></span></code></pre></div></div></div><p>The <code>sqlite-jdbc-3.45.1.0.jar</code> can be found at the <a href="https://github.com/xerial/sqlite-jdbc/releases/download/3.45.1.0/sqlite-jdbc-3.45.1.0.jar" target="_blank" rel="noreferrer">Maven Repository</a>. I would suggest using the version number that matches the SQLite version.</p><h3 id="reading-a-file" tabindex="-1">Reading a File <a class="header-anchor" href="#reading-a-file" aria-label="Permalink to “Reading a File”">​</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-2848" id="tab-2849" checked><label data-title="SQLite" for="tab-2849">SQLite</label><input type="radio" name="group-2848" id="tab-2850"><label data-title="Pandas" for="tab-2850">Pandas</label><input type="radio" name="group-2848" id="tab-2851"><label data-title="Polars" for="tab-2851">Polars</label><input type="radio" name="group-2848" id="tab-2852"><label data-title="Spark" for="tab-2852">Spark</label></div><div class="blocks"><div class="language-sql active"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> customers;</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;../data/customers.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.head()</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> polars </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pl.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;../data/customers.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.head()</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pyspark.sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparkSession</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spark </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparkSession.builder.appName(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DataProcessing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).master(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;local[*]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).getOrCreate()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> spark.read.csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;../data/customers.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">header</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inferSchema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.show(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></div></div>`,11)])])}const c=d(e,[["render",r]]);export{m as __pageData,c as default};
