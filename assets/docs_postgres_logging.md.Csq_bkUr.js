import{_ as s,c as a,o as i,ah as t}from"./chunks/framework.BaqsfJuc.js";const p=JSON.parse('{"title":"Postgres Logging","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"docs/postgres/logging.md","filePath":"docs/postgres/logging.md"}'),o={name:"docs/postgres/logging.md"};function l(n,e,r,h,d,g){return i(),a("div",null,[...e[0]||(e[0]=[t(`<h1 id="postgres-logging" tabindex="-1">Postgres Logging <a class="header-anchor" href="#postgres-logging" aria-label="Permalink to “Postgres Logging”">​</a></h1><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to “Introduction”">​</a></h2><p>PostgreSQL offers three methods for logging server messages.</p><ol><li><strong>stderr</strong> -- Found at log/postgresql.log</li><li><strong>csvlog</strong> -- Found at log/postgresql.csv</li><li><strong>jsonlog</strong> -- Found at log/postgresql.json</li></ol><p>The default is <code>stderr</code>.</p><div class="tip custom-block"><p class="custom-block-title">NOTE</p><p>PostgreSQL does offer an additional method on Windows, and this is <code>eventlog</code></p></div><p>If at any point you want to interrogate PostgreSQL to find the current value of a parameter, for example, in what directory logs located, execute a <code>SHOW</code> command and append the parameter.</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">postgresql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># SHOW LOG_DIRECTORY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> log_directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> log</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Here we see the location of <strong>LOG_DIRECTORY</strong> as <code>log</code>.</p><p>If you want to know where to locate your <code>postgresql.conf</code> file where these parameters and more are located you can execute another <code>SHOW</code> command and append the argument <code>config_file</code>.</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">postgresql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># SHOW config_file;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-----------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> C:/Program</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Files/PostgreSQL/18/data/postgresql.conf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>To change the value of a parameter, the easiest way, is to open the <code>conf</code> file and change it manually. You will find in these docs the line number where the parameter can be found.</p><p>Then reload your configuration:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">postgresql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># SELECT </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_reload_conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pg_reload_conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">----------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> t</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">If you haven&#39;t noticed</p><p>I am purposefully not making these commands easy to copy and paste, because I would rather you to type them out manually.</p></div><hr><h5 id="below-is-a-collection-of-parameters-that-affect-how-postgresql-implements-logging-on-the-server" tabindex="-1">Below is a collection of parameters that affect how PostgreSQL implements logging on the server. <a class="header-anchor" href="#below-is-a-collection-of-parameters-that-affect-how-postgresql-implements-logging-on-the-server" aria-label="Permalink to “Below is a collection of parameters that affect how PostgreSQL implements logging on the server.”">​</a></h5><h2 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to “Parameters”">​</a></h2><blockquote><h3 id="logging-collector" tabindex="-1">LOGGING_COLLECTOR <a class="header-anchor" href="#logging-collector" aria-label="Permalink to “LOGGING_COLLECTOR”">​</a></h3><h5 id="boolean-491" tabindex="-1">(BOOLEAN) <code>#491</code> <a class="header-anchor" href="#boolean-491" aria-label="Permalink to “(BOOLEAN) #491”">​</a></h5></blockquote><p>This will enable the <code>logging_collector</code>. The PostgreSQL Docs describe this as a background process that captures log messages that are then sent to <code>stderr</code> by default, or whatever is the value of <code>LOGGING_DESTINATION</code>.</p><h4 id="important-notes" tabindex="-1">Important Notes <a class="header-anchor" href="#important-notes" aria-label="Permalink to “Important Notes”">​</a></h4><ol><li>It is possible to log to <code>stderr</code> without using the logging collector; the log messages will end up wherever the server&#39;s <code>stderr</code> is directed. PostgreSQL does not reccommend this for high volume logs, however.</li><li>The logging collector is not designed to loose messages. This means that under high volume the server could suffer blockage while trying to send additional logs if and when the collector has fallen behind.</li></ol><div class="tip custom-block"><p class="custom-block-title">NOTE</p><p>The <code>logging_collector</code> parameter can only be set at server start.</p></div><blockquote><h3 id="logging-destination" tabindex="-1">LOGGING_DESTINATION <a class="header-anchor" href="#logging-destination" aria-label="Permalink to “LOGGING_DESTINATION”">​</a></h3><h5 id="string-484" tabindex="-1">(STRING) <code>#484</code> <a class="header-anchor" href="#string-484" aria-label="Permalink to “(STRING) #484”">​</a></h5></blockquote><p>PostgreSQL supports several methods for logging server messages, including stderr, csvlog, jsonlog, and syslog. On Windows, eventlog is also supported. Set this parameter to a list of desired log destinations separated by commas. The default is to log to stderr only. This parameter can only be set in the postgresql.conf file or on the server command line.</p><p>If csvlog is included in log_destination, log entries are output in “comma-separated value” (CSV) format, which is convenient for loading logs into programs. See Section 19.8.4 for details. logging_collector must be enabled to generate CSV-format log output.</p><p>If jsonlog is included in log_destination, log entries are output in JSON format, which is convenient for loading logs into programs. See Section 19.8.5 for details. logging_collector must be enabled to generate JSON-format log output.</p><p>When either stderr, csvlog or jsonlog are included, the file current_logfiles is created to record the location of the log file(s) currently in use by the logging collector and the associated logging destination. This provides a convenient way to find the logs currently in use by the instance. Here is an example of this file&#39;s content:</p><blockquote><h3 id="log-directory" tabindex="-1">LOG_DIRECTORY <a class="header-anchor" href="#log-directory" aria-label="Permalink to “LOG_DIRECTORY”">​</a></h3><h5 id="string-497" tabindex="-1">(STRING) <code>#497</code> <a class="header-anchor" href="#string-497" aria-label="Permalink to “(STRING) #497”">​</a></h5></blockquote><p>When <code>logging_collector</code> is enabled, this parameter <code>logging_directory</code> will determine the directory in which log files will be placed.</p><h4 id="important-notes-1" tabindex="-1">Important Notes <a class="header-anchor" href="#important-notes-1" aria-label="Permalink to “Important Notes”">​</a></h4><ol><li>The filename path can be specified as an absolute path, or relative to the cluster data directory.</li><li>This parameter can only be set in the postgresql.conf file or on the server command line.</li><li>The default is <code>log</code>.</li></ol><div class="warning custom-block"><p class="custom-block-title">NOTE</p><p>On most Unix systems, you will need to alter the configuration of your system&#39;s syslog daemon in order to make use of the syslog option for log_destination. PostgreSQL can log to syslog facilities LOCAL0 through LOCAL7 (see syslog_facility), but the default syslog configuration on most platforms will discard all such messages. You will need to add something like:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">local0.*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    /var/log/postgresql</span></span></code></pre></div><p>to the syslog daemon&#39;s configuration file to make it work.</p><p>On Windows, when you use the eventlog option for log_destination, you should register an event source and its library with the operating system so that the Windows Event Viewer can display event log messages cleanly. See Section 18.12 for details.</p></div>`,33)])])}const k=s(o,[["render",l]]);export{p as __pageData,k as default};
